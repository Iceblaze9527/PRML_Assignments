# 第二次作业_2
> 新雅62/CDIE6 
> 2016013327 项雨桐

## 2.8 计算机小实验1：线性回归练习

请对附件中的数据(``prostate_train.txt`` 和 ``prostate_test.txt``)使用前四个临床数据(即``lcavol``，``lweight``，``lbph``，``svi``)对前列腺特异抗原水平(``lpsa``)进行预测。 所给出的文件中，前 4 列每列代表一个临床数据(即特征)，最后一列是测量的前列腺特异抗原水平(即预测目标的真实值)；每行代表一个样本。

作业要求:  
* 在不考虑交叉项的情况下，利用Linear Regression 对``prostate_train.txt``的数据进行回归，给出回归结果，并对 ``prostate_test.txt``文件中的患者进行预测，给出结果评价。  
* 如果考虑交叉项，是否会有更好的预测结果？请给出你的理由。 

数据名词解释:
```sh
lcavol:log cancer volume
lweight:log prostate weight
lbph:log of the amount of benign prostatic hyperplasia
svi:seminal vesicle invasion
lpsa:level of prostate-specific antigen
```

------ 

答：
1. 无交叉项部分得到的回归系数为

lcavol | lweight | lbph | svi |intercept
--| -- | -- |-- |--
0.50552085 | 0.5388292 | 0.1400111 | 0.67184865 | -0.325921234088

2. 交叉项部分采用所有的交叉项，得到的回归系数为

lcavol | lweight | lbph | svi | 12 | 13| 14 | 23 | 24 | 34| intercept
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
0.75872914  | 0.72396096 | 1.23365227 | 4.35858042 | -0.0709226 | 0.04191441 | -0.1955892 | -0.30074332 | -0.87112746 | -0.21748648 | -0.882982674068

3. 无交叉项部分的预测结果为
```py
[ 2.00449631  0.99462147  1.34104092  1.94428589  2.80801432  2.06887115
  2.13115131  1.80905482  2.05487204  1.24572611  2.85937501  2.19334314
  2.4753094   2.67626965  2.24731416  2.40617803  2.10025142  3.21743353
  2.96871831  1.51641713  3.58665261  3.7662857   2.48019576  2.66356745
  2.82721828  3.08095822  2.94509462  3.25201811  3.45156972  4.30428439]
```
4. 有交叉项部分的预测结果为
```py
[ 2.14470272  1.09584489  1.21343833  1.88427535  3.09655859  2.19905111
  2.26267865  1.82023638  2.12601095  1.13949148  2.81743808  2.24199304
  2.60428986  2.70596052  2.18763124  2.608396    2.24694355  3.24005007
  2.84124502  1.16026582  3.49567989  3.32595821  2.46003231  2.79059492
  3.38275638  3.66522235  2.96230812  3.41207126  3.75107586  3.85221037]
```
5. 无交叉部分性能指标
* $R^2  = 0.565250282204$
* $\operatorname{MSE} = 0.45633212204$

6. 有交叉部分性能指标
* $R^2  = 0.493714539887$
* $\operatorname{MSE} =0.531419133618$

性能指标的结果显示，加入所有的交叉项对改善预测性能并无帮助。

## 2.9 计算机小实验2：线性分类器练习
请对附件中的数据(``breast-cancer-wisconsin.txt``，来自于 UCIML)，使用罗杰斯特回归和 Fisher 线性判别设计分类器，实现良性和恶性乳腺癌的分类和预测，给出正确率并对这两种方法做出比较。

附件乳腺癌诊断数据集是699 × 11维的矩阵，11维的特征信息如下。

``Attribute Domain``

serial | name | range
-- | -- | --
1. | Sample code number | id number
2. | Clump Thickness | 1 - 10
3. | Uniformity of Cell Size | 1 - 10
4. | Uniformity of Cell Shape | 1 - 10
5. | Marginal Adhesion | 1 - 10
6. | Single Epithelial Cell Size | 1 - 10
7. | Bare Nuclei | 1 - 10
8. | Bland Chromatin | 1 - 10
9. | Normal Nucleoli | 1 - 10
10. | Mitoses | 1 - 10
11. | Class: | (0 for benign, 1 for malignant)

要求：Logistic 回归可以调用函数，Fisher 线性判别请自行编写程序实现。

---

答：
Logistic回归采用了5折交叉验证，系数如下：

Clump Thickness | Uniformity of Cell Size | Uniformity of Cell Shape |  Marginal Adhesion | Single Epithelial Cell Size | Bare Nuclei | Bland Chromatin | Normal Nucleoli | Mitoses | intercept
-- | -- | -- | -- | -- | -- | -- | -- | -- | --
0.52603063 | -0.06659919 | 0.3236895 |  0.29804726 | 0.12426795 | 0.36230969 | 0.35821194 | 0.19446375 | 0.46607639 | -9.22746545

准确率为100%

Fisher线性判别得到的系数如下

Clump Thickness | Uniformity of Cell Size | Uniformity of Cell Shape |  Marginal Adhesion | Single Epithelial Cell Size | Bare Nuclei | Bland Chromatin | Normal Nucleoli | Mitoses | intercept
-- | -- | -- | -- | -- | -- | -- | -- | -- | --
-0.00179037 | -0.00055191 | -0.00090057 | -0.00040891 | -0.00050946 | -0.00227471 | -0.00055596 |  -0.00094394 | -0.00023939 | 0.0345932377178

准确率99.45%

从数据可知，Logistic Regression的分类准确率比Fisher线性判别模型更高，但Fisher线性判别模型更加简单。

## 附录：环境
本次实验所用环境已导出到``config.yaml``，以供复现时参考
导入环境可以用：
```sh
conda env create -f config.yaml
```
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTc3Mjg0NjEzNV19
-->