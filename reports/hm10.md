# ç¬¬åæ¬¡ä½œä¸š

> æ–°é›…62/CDIE6
> 2016013327 é¡¹é›¨æ¡

## 12.1
å‡è®¾æˆ‘ä»¬çš„æ ·æœ¬é›†$D=\{x_1,x_2,...,x_n\}$æ¥è‡ªäºğ‘˜ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œå³$p_{M}(\boldsymbol{x})=\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x} | \boldsymbol{\mu}_{j}, \mathbf{\Sigma}_{j}\right)$ï¼Œå…¶ä¸­$\alpha_{j}, \boldsymbol{\mu}_{j}, \mathbf{\Sigma}_{j}$æ˜¯æ··åˆé«˜æ–¯åˆ†å¸ƒç¬¬jä¸ªæˆåˆ†çš„æ¯”ä¾‹ã€å‡å€¼ä»¥åŠåæ–¹å·®çŸ©é˜µï¼Œè¯•æ¨å¯¼é‡‡ç”¨ EM ç®—æ³•æ±‚è§£æ··åˆé«˜æ–¯æ¨¡å‹å‚æ•°çš„è¿‡ç¨‹ã€‚

1. æ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œæ±‚åéªŒæœŸæœ›ï¼Œå†™å‡ºéœ€è¦æœ€å¤§åŒ–çš„å‡½æ•°å½¢å¼[^1]ã€‚ 

> å¼•å…¥ä¸€ä¸ªæ–°çš„$k$ç»´éšæœºå˜é‡$\boldsymbol{z}$ï¼Œ$z_jâˆˆ\{0,1\}, j=1,2,\ldots, k$ï¼›$z_j=1$è¡¨ç¤º$j$ç±»è¢«é€‰ä¸­çš„æ¦‚ç‡ï¼Œå³ $p(z_j=1)=\alpha_j$â€‹ï¼›$z_j=0$ è¡¨ç¤ºç¬¬$j$ç±»æ²¡æœ‰è¢«é€‰ä¸­çš„æ¦‚ç‡ã€‚ åˆ™ï¼š$$p_{M}(\boldsymbol{x})=\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x} | \boldsymbol{\mu}_{j}, \mathbf{\Sigma}_{j}\right) = \sum_{j=1}^{k}p(z_j=1) p\left(\boldsymbol{x} | z_{j}=1\right)$$åéªŒæœŸæœ›$$
\begin{aligned}
\gamma_{ij} =p\left(z_{j}=1 | \boldsymbol{x}_i\right) 
&=\frac{p\left(z_{j}=1\right) p\left(\boldsymbol{x}_i | z_{j}=1\right)}{p\left( \boldsymbol{x}_i, z_{j}=1\right)} \\
&=\frac{p\left(z_{j}=1\right) p\left( \boldsymbol{x}_i | z_{j}=1\right)}{\sum_{j=1}^{k} p\left(z_{j}=1\right) p\left( \boldsymbol{x}_i | z_{j}=1\right)} \\
&= \frac{\alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}\\
& = \frac{\alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}{p_{M}(\boldsymbol{x}_i)}
\end{aligned}
$$å¯¹æ•°ä¼¼ç„¶$$
H=\ln \left(\prod_{i=1}^{n} p_{M}\left(\boldsymbol{x}_i \right)\right)=\sum_{i=1}^{n} \ln \left(\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i |\boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)\right)\\
s.t. \quad \alpha_{j} \geqslant 0 ; \quad \sum_{j=1}^{k} \alpha_{j}=1
$$

2. æœ€å¤§åŒ–(1)ä¸­çš„å‡½æ•°ï¼Œå†™å‡ºæ¨¡å‹å‚æ•°$\alpha_{j}, \boldsymbol{\mu}_{j}, \mathbf{\Sigma}_{j}$çš„æ›´æ–°å…¬å¼[^2]ã€‚

> Lagrangeä¹˜å­æ³•ï¼š
> $$\mathcal{L} = \sum_{i=1}^{n} \ln \left(\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i |\boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)\right) + \lambda(\sum_{j=1}^{k} \alpha_{j}-1)$$ä»¤$$\begin{aligned}\frac{\partial \mathcal{L}}{\partial \alpha_j} = 0\\
\frac{\partial \mathcal{L}}{\partial \boldsymbol{\mu}_j} = 0\\
\frac{\partial \mathcal{L}}{\partial \boldsymbol{\Sigma}_j} = 0\\
\end{aligned}$$å¯¹äº$\frac{\partial \mathcal{L}}{\partial \alpha_j} = 0$ï¼Œæœ‰$$\sum_{i=1}^{n} \frac{\mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}+\lambda = 0$$ä¸¤è¾¹åŒä¹˜ä»¥$\alpha_j$ï¼Œå¯å¾—$$\sum_{i=1}^{n} \frac{\alpha_{j}\mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}+\lambda\alpha_{j} = \sum_{i=1}^{n}\gamma_{ij} + \lambda\alpha_{j} = 0$$å› ä¸º$\sum_{j=1}^{k} \alpha_{j}=1$ã€$\sum_{j=1}^{k} \gamma_{ij}=1$ï¼Œä¸¤è¾¹å¯¹æ‰€æœ‰çš„$j$æ±‚å’Œï¼Œå¾—$$\sum_{i=1}^{n}\sum_{j=1}^{k}\gamma_{ij} + \lambda\sum_{j=1}^{k}\alpha_{j} = n+\lambda=0$$å¾—$n=-\lambda$ï¼Œä»£å…¥åŸå¼ä¸­å¾—ï¼š$$\alpha_{j}=\frac{1}{n} \sum_{i=1}^{n} \gamma_{i j}$$å¯¹äº$\frac{\partial \mathcal{L}}{\partial \boldsymbol{\mu}_{j}} = 0$ï¼Œæœ‰$$\sum_{i=1}^{n} \frac{ \alpha_{j}\frac{\partial}{\partial \boldsymbol{\mu}_{j}} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}=0$$è€Œ$$\begin{aligned}\frac{\partial}{\partial \boldsymbol{\mu}_{j}} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right) &= \frac{\partial}{\partial \boldsymbol{\mu}_{j}} \left[\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}} \exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\right] \\&= -\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}} \exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\cdot \left[\boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right]\\&= -\mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right) \left[\boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right]\end{aligned}$$å› æ­¤$$\begin{aligned}\frac{\partial \mathcal{L}}{\partial \boldsymbol{\mu}_{j}} &= - \sum_{i=1}^{n} \frac{\alpha_{j}\mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)\left[\boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right]}{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)} \\&= - \sum_{i=1}^{n} \gamma_{ij} \left[\boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right]\\&=0\end{aligned}$$ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$\boldsymbol{\Sigma}_{j}$ï¼Œæ•´ç†å¯å¾—$$\boldsymbol{\mu}_{j}=\frac{\sum_{i=1}^{n} \gamma_{i j} \boldsymbol{x}_{i}}{\sum_{i=1}^{n} \gamma_{i j}}$$å¯¹äº$\frac{\partial \mathcal{L}}{\partial \boldsymbol{\Sigma}_{j}} = 0$ï¼Œæœ‰$$\sum_{i=1}^{n} \frac{ \alpha_{j}\frac{\partial}{\partial \boldsymbol{\Sigma}_{j}} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)}=0$$è€Œ$$\begin{aligned}\frac{\partial}{\partial \boldsymbol{\Sigma}_{j}} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right) &= \frac{\partial}{\partial \boldsymbol{\Sigma}_{j}} \left[\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}} \exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\right] \\&= \frac{\partial}{\partial \boldsymbol{\Sigma}_{j}}\left(\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}}\right)\cdot \exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\} \\&+\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}}\cdot \frac{\partial}{\partial \boldsymbol{\Sigma}_{j}}\left(\exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\right) \end{aligned}$$å·²çŸ¥$$
\frac{\partial}{\partial \mathbf{A}} \ln |\mathbf{A}|=\left(\mathbf{A}^{-1}\right)^{T}
$$å› æ­¤å¯¹äºå®å¯¹ç§°çŸ©é˜µ$\boldsymbol{\Sigma}_{j}$ï¼Œ$$\begin{aligned}\frac{\partial}{\partial \boldsymbol{\Sigma}_{j}}\left(\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}}\right) &= \frac{1}{(2 \pi)^{d / 2}}\cdot \frac{\partial}{\partial \ln |\boldsymbol{\Sigma}_{j}|}|\boldsymbol{\Sigma}_{j}|^{-1 / 2}\cdot \frac{\partial}{\partial \boldsymbol{\Sigma}_{j}} \ln |\boldsymbol{\Sigma}_{j}|\\&=\frac{-\frac{1}{2}\boldsymbol{\Sigma}_{j}^{-1}}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}}\end{aligned}$$è€Œ$$\begin{aligned}\frac{\partial}{\partial \boldsymbol{\Sigma}_{j}}\left(\exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\right) &= -\frac{1}{2}\exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\cdot\\&\left[ -\boldsymbol{\Sigma}_{j}^{-1}\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)^{T}  \boldsymbol{\Sigma}_{j}^{-1}\right]\end{aligned}$$å› æ­¤$$\begin{aligned}\frac{\partial}{\partial \boldsymbol{\Sigma}_{j}} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right) &= \frac{-\frac{1}{2}\boldsymbol{\Sigma}_{j}^{-1}}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}} \exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\} \\& +\frac{1}{(2 \pi)^{d / 2}|\boldsymbol{\Sigma}_{j}|^{1 / 2}}\cdot\left(-\frac{1}{2}\exp \left\{-\frac{1}{2}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})^{T} \boldsymbol{\Sigma}_{j}^{-1}(\boldsymbol{x}_i-\boldsymbol{\mu}_{j})\right\}\cdot \left[ -\boldsymbol{\Sigma}_{j}^{-1}\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)^{T}  \boldsymbol{\Sigma}_{j}^{-1}\right]\right)\\&=
 -\frac{1}{2}\mathcal{N}\left(\boldsymbol{x}_i| \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)\left[ \boldsymbol{\Sigma}_{j}^{-1} - \boldsymbol{\Sigma}_{j}^{-1}\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)\cdot \left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)^{T}  \boldsymbol{\Sigma}_{j}^{-1}\right] \end{aligned}$$å› æ­¤$$\begin{aligned}\frac{\partial \mathcal{L}}{\partial \boldsymbol{\Sigma}_{j}} &=  -\frac{1}{2} \sum_{i=1}^{n} \frac{\alpha_{j}\mathcal{N}\left(\boldsymbol{x}_i| \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right) \left[ \boldsymbol{\Sigma}_{j}^{-1} - \boldsymbol{\Sigma}_{j}^{-1}\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)\cdot \left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)^{T}  \boldsymbol{\Sigma}_{j}^{-1}\right] }{\sum_{j=1}^{k} \alpha_{j} \mathcal{N}\left(\boldsymbol{x}_i | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}\right)} \\&= -\frac{1}{2} \sum_{i=1}^{n} \gamma_{ij} \left[ \boldsymbol{\Sigma}_{j}^{-1} - \boldsymbol{\Sigma}_{j}^{-1}\left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)\cdot \left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)^{T}  \boldsymbol{\Sigma}_{j}^{-1}\right] \\&=0\end{aligned}$$ä¸¤è¾¹åŒæ—¶å·¦å³å‡ä¹˜ä»¥$\boldsymbol{\Sigma}_{j}$ï¼Œæ•´ç†å¯å¾—$$\boldsymbol{\Sigma}_{j}=\frac{\sum_{i=1}^{n} \gamma_{i j} \left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)\cdot \left(\boldsymbol{x}_i-\boldsymbol{\mu}_{j}\right)^{T}}{\sum_{i=1}^{n} \gamma_{i j}}$$

## 12.2 
ç°æœ‰ 8 ä¸ªä¸€ç»´æ ·æœ¬ç‚¹å¦‚ä¸‹:  
$$\{âˆ’5.5, âˆ’4.1, âˆ’3.0, âˆ’2.6, 10.1, 11.9, 12.3, 13.6\}$$è¯·å°è¯•é‡‡ç”¨åˆ†çº§èšç±»çš„æ–¹æ³•å¯¹ä¸Šè¿°æ ·æœ¬è¿›è¡Œèšç±»ï¼Œå…¶ä¸­ç±»åˆ«ä¹‹é—´çš„è·ç¦»å®šä¹‰ä¸º $d_{\min }\left(\mathrm{D}_{i}, \mathrm{D}_{j}\right)$ï¼Œ$d_{\min }\left(\mathrm{D}_{i}, \mathrm{D}_{j}\right)= \min _{x \in D_{i}\\x^{\prime} \in D_{j}}\left\|x-x^{\prime}\right\|$ ã€‚

ç”»å‡ºèšç±»æ ‘ï¼Œæ³¨æ˜æ¨ªçºµåæ ‡å€¼ï¼Œå¹¶è¯´æ˜ä½ å€¾å‘äºå°†è¿™äº›æ•°æ®èšä¸ºå‡ ç±»ï¼Œä¸ºä»€ä¹ˆã€‚

> åˆ†çº§èšç±»è¿‡ç¨‹å¦‚ä¸‹ï¼š
> 1. åŸå§‹çŸ©é˜µï¼š

|   | A | B   | C   | D   | E    | F    | G    | H    |
|---|---|-----|-----|-----|------|------|------|------|
| A | - | 1.4 | 2.5 | 2.9 | 15.6 | 17.4 | 17.8 | 19.1 |
| B |   |  -  | 1.1 | 1.5 | 14.2 | 16   | 16.4 | 17.7 |
| C |   |     |  -  | ==0.4== | 13.1 | 14.9 | 15.3 | 16.6 |
| D |   |     |     |  -  | 12.7 | 14.5 | 14.9 | 16.2 |
| E |   |     |     |     |   -  | 1.8  | 2.2  | 3.5  |
| F |   |     |     |     |      |   -  | 0.4  | 1.7  |
| G |   |     |     |     |      |      |  -   | 1.3  |
| H |   |     |     |     |      |      |      |  -   |

> 2. CDåˆå¹¶ï¼š

|    | A | B   | CD  | E    | F    | G    | H    |
|----|---|-----|-----|------|------|------|------|
| A  | - | 1.4 | 2.5 | 15.6 | 17.4 | 17.8 | 19.1 |
| B  |   |  -  | 1.1 | 14.2 | 16   | 16.4 | 17.7 |
| CD |   |     |  -  | 12.7 | 14.5 | 14.9 | 16.2 |
| E  |   |     |     |  -   | 1.8  | 2.2  | 3.5  |
| F  |   |     |     |      |  -   | ==0.4==  | 1.7  |
| G  |   |     |     |      |      |  -  | 1.3  |
| H  |   |     |     |      |      |      |  -   |

> 3. FGåˆå¹¶ï¼š

|    | A | B   | CD  | E    | FG   | H    |
|----|---|-----|-----|------|------|------|
| A  | - | 1.4 | 2.5 | 15.6 | 17.4 | 19.1 |
| B  |   |  -  | ==1.1== | 14.2 | 16   | 17.7 |
| CD |   |     |  -  | 12.7 | 14.5 | 16.2 |
| E  |   |     |     |  -   | 1.8  | 3.5  |
| FG |   |     |     |      |  -   | 1.3  |
| H  |   |     |     |      |      |   -  |

> 4. BCDåˆå¹¶ï¼š

|     | A | BCD | E    | FG   | H    |
|-----|---|-----|------|------|------|
| A   | - | 1.4 | 15.6 | 17.4 | 19.1 |
| BCD |   |  -  | 12.7 | 14.5 | 16.2 |
| E   |   |     |  -   | 1.8  | 3.5  |
| FG  |   |     |      |   -  | ==1.3==  |
| H   |   |     |      |      |   -  |

> 5. FGHåˆå¹¶ï¼š

|     | A | BCD | E    | FGH  |
|-----|---|-----|------|------|
| A   |-  | ==1.4== | 15.6 | 17.4 |
| BCD |   |  -  | 12.7 | 14.5 |
| E   |   |     |  -   | 1.8  |
| FGH |   |     |      |  -   |

> 6. ABCDåˆå¹¶ï¼š

|      | ABCD | E    | FGH  |
|------|------|------|------|
| ABCD |  -   | 12.7 | 14.5 |
| E    |      |  -   | ==1.8==  |
| FGH  |      |      |   -  |

> 7. EFGHåˆå¹¶ï¼š

|      | ABCD | EFGH |
|------|------|------|
| ABCD |      | 12.7 |
| EFGH |      |      |

> èšç±»æ ‘å¦‚ä¸‹ï¼š
> <a href="https://sm.ms/image/Vu9MDzgs5ZQAtjO" target="_blank"><img src="https://i.loli.net/2020/04/26/Vu9MDzgs5ZQAtjO.png" width="30%" ></a>
> æˆ‘å€¾å‘äºå°†è¿™äº›æ•°æ®èšæˆ2ç±»ã€‚å› ä¸ºåœ¨åˆ†æˆä¸¤ç±»æ—¶ç±»é—´è·ç¦»å¾ˆå¤§ï¼Œç›¸ä¼¼ç¨‹åº¦å¾ˆä½ï¼›ç±»å†…è·ç¦»å¾ˆå°ï¼Œç›¸ä¼¼ç¨‹åº¦å¾ˆé«˜ï¼Œå› æ­¤å¯ä»¥è¾ƒå¥½åœ°æŠŠä¸¤ç±»åŒºåˆ«å‡ºæ¥ã€‚

## 12.3 è®¡ç®—æœºå°å®éªŒ:MNSIT æ•°æ®é›†èšç±»  
åœ¨æœ¬é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨èšç±»ç®—æ³•å¯¹ MNIST è®­ç»ƒé›†çš„â€œ0â€ï¼Œâ€œ1â€ï¼Œâ€œ2â€ ä¸‰ç±»æ ·æœ¬é›†è¿›è¡Œèšç±»åˆ†æï¼Œå¹¶è§‚å¯Ÿå„èšç±»ç®—æ³•çš„æ€§èƒ½å·®å¼‚ã€‚

1.  è¯·åˆ©ç”¨ K-means ç®—æ³•ï¼Œåœ¨ 1 åˆ° 10 çš„ç±»åˆ«æ•°ä¸‹å¯¹æ ·æœ¬é›†è¿›è¡Œèšç±»ï¼Œåˆ†åˆ«ä½¿ç”¨è¯¯å·®å¹³æ–¹å’Œ$J_e$å’Œè½®å»“ç³»æ•° SC ç¡®å®šèšç±»æ•°ç›®ï¼Œå¹¶ç»“åˆçœŸå®çš„ç±»åˆ«æ•°è¿›è¡Œåˆ†æã€‚

> è¯¯å·®å¹³æ–¹å’Œä¸èšç±»æ•°ç›®çš„å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š 
> <a href="https://sm.ms/image/GQVbFpHvjJSMAa3" target="_blank"><img src="https://i.loli.net/2020/04/26/GQVbFpHvjJSMAa3.png" ></a>
> è½®å»“ç³»æ•°ä¸èšç±»æ•°ç›®çš„å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š
> <a href="https://sm.ms/image/VLdBtfqNEap8GWP" target="_blank"><img src="https://i.loli.net/2020/04/26/VLdBtfqNEap8GWP.png" ></a>
> ä»å›¾ä¸­å¯ä»¥å¾—çŸ¥ï¼Œåˆ©ç”¨è¯¯å·®å¹³æ–¹å’Œåˆ¤æ–­å¾—åˆ°çš„æœ€ä½³èšç±»æ•°ç›®ä¸º3ï¼Œåˆ©ç”¨è½®å»“ç³»æ•°åˆ¤æ–­å¾—åˆ°çš„æœ€ä½³èšç±»æ•°ç›®ä¸º2ã€‚äºŒè€…å¾—åˆ°çš„ç»“è®ºå‡æ¥è¿‘å®é™…çš„ç±»åˆ«æ•°ã€‚å¯¹äºè½®å»“ç³»æ•°åˆ¤æ®ï¼Œèšç±»æ•°ç›®ä¸º3æ—¶çš„SCå€¼ä¹Ÿè¾ƒé«˜ï¼Œè¯´æ˜åœ¨è¿™ä¸ªåŸºå‡†ä¸‹3å¯èƒ½ä¹Ÿæ˜¯å¯è¡Œçš„èšç±»æ•°ç›®ã€‚

2.  è¯·åˆ©ç”¨ K-means ç®—æ³•å¯¹æ ·æœ¬é›†è¿›è¡Œèšç±»(ç±»åˆ«æ•°ä¸º 3)ï¼Œåœ¨ç®—æ³•ä¸­å°è¯•ä¸‰ç§ä¸åŒçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¹¶é‡‡ç”¨ NMI è¯„ä¼°ä½ çš„èšç±»ç»“æœ(å¤šæ¬¡è¿è¡Œå–å¹³å‡å€¼)ï¼Œç®€è¿°å„åˆå§‹åŒ–æ–¹æ³•çš„ç‰¹ç‚¹ã€‚
    
 > ä¸‰ç§ä¸åŒçš„åˆå§‹åŒ–æ–¹æ³•ï¼š
 >1.  `k-means++`ï¼šä¸€ç§åŠ é€Ÿæ”¶æ•›çš„å¯»æ‰¾èšç±»ä¸­å¿ƒçš„æ–¹æ³•ï¼Œæµç¨‹å¦‚ä¸‹[^3][^4]ï¼š
 >---
 >a. ä»¥ä¸€è‡´çš„æ¦‚ç‡ï¼Œéšæœºä»æ•°æ®é›†$\mathcal{X}$ä¸­é€‰å–ä¸€ä¸ªèšç±»ä¸­å¿ƒ $c_{1}$ 
 >b. å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªç‚¹$x$ï¼Œè®¡ç®—å®ƒä¸å·²é€‰æ‹©çš„èšç±»ä¸­å¿ƒä¸­æœ€è¿‘èšç±»ä¸­å¿ƒçš„è·ç¦» $D\left(x\right)=\arg \min \left\|x-\mu_{r}\right\|_{2}^{2} \quad r=1,2, \ldots i-1$
 >c. ä»¥æ¦‚ç‡ $\frac{D(x)^{2}}{\sum_{x \in \mathcal{X}} D(x)^{2}}$ï¼Œä»æ•°æ®é›†$\mathcal{X}$ä¸­é€‰æ‹©ä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹ä½œä¸ºæ–°çš„èšç±»ä¸­å¿ƒ $c_{i}$
 >d. é‡å¤b.å’Œc.ï¼Œ ç›´è‡³é€‰å–å‡º$k$ä¸ªèšç±»ä¸­å¿ƒ
 >
 > ---
 >
 >2. `random`ï¼šéšæœºé€‰å–$k$ä¸ªæ ·æœ¬ç‚¹ä½œä¸ºåˆå§‹åŒ–ä¸­å¿ƒ
 >3. `density`ï¼šè®¡ç®—æ¯ä¸ªæ ·æœ¬çš„ä¸€å®šçƒå½¢é‚»åŸŸå†…çš„æ ·æœ¬æ•°ä½œä¸ºâ€œå¯†åº¦â€ï¼Œé€‰â€œå¯†åº¦â€æœ€å¤§çš„æ ·æœ¬ç‚¹ä½œä¸ºç¬¬ä¸€ä¸ªä»£è¡¨ç‚¹ï¼Œåœ¨ç¦»å®ƒä¸€å®šè· ç¦»ä¹‹å¤–é€‰æœ€å¤§â€œå¯†åº¦â€ç‚¹ä½œä¸ºç¬¬äºŒä¸ªä»£è¡¨ç‚¹ï¼Œ...ï¼Œä¾æ¬¡ç±»æ¨ã€‚è¿™é‡Œå¯†åº¦æœ€å¤§ç‚¹çš„æœç´¢ç”¨æ ¸å‡½æ•°ä¼°è®¡ä¸­çš„é«˜å¸½çª—(`tophat`)ä»£ä¸ºæ±‚è§£ã€‚
 >
 >å®éªŒä¸­è¿è¡Œä¸‰æ¬¡å–å¹³å‡å€¼ï¼Œåˆ©ç”¨NMIè¡¡é‡å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š
```
nmi averages:
k-means++: 0.7486470882900723
random: 0.7483731389979114
density: 0.7486969260690296
```
> å¯è§èšç±»æ•ˆæœï¼š`random`<`k-means++`<`density`
>
> * `random`åˆå§‹åŒ–æ–¹æ³•ååˆ†ç®€å•ï¼Œä½†å› ä¸ºæ˜¯å®Œå…¨éšæœºçš„é€‰å–ï¼Œæ•ˆæœè¾ƒå·®ï¼›
> * `k-means++`åˆå§‹åŒ–æ–¹æ³•å°†èšç±»ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é™åˆ°äº†$O(\log k)-$ Competitive[^3]ï¼Œä¹Ÿèƒ½å¾ˆå¥½åœ°æå‡èšç±»çš„æ•ˆæœ
> * `density`åˆå§‹åŒ–æ–¹æ³•ç”±äºè€ƒè™‘äº†æ•°æ®ç‚¹é‚»åŸŸçš„å¯†åº¦ï¼Œèšç±»æ•ˆæœæ˜¯æœ€å¥½çš„ï¼Œä½†å¯»æ‰¾è¿™æ ·çš„åˆå§‹åŒ–ç‚¹çš„è®¡ç®—æ—¶ç©ºå¼€é”€ä¹Ÿæ˜¯æœ€å¤§çš„
> * æ‰€æœ‰åˆå§‹åŒ–ç®—æ³•éƒ½æ˜¯ç¨³å®šçš„
> * å¦‚æœç”¨ground-truthçš„åˆ†ç±»å‡†ç¡®ç‡è¡¡é‡ï¼Œä¸‰è€…å‡†ç¡®ç‡åˆ†åˆ«ä¸ºï¼š
```
k-means++: 0.9259612329202415
random: 0.925007944073721
density: 0.9253257070225611
```
> å¯è§`k-means++`çš„ç»¼åˆæ€§èƒ½æ˜¯æœ€ä¼˜çš„

3.  è¯·åˆ©ç”¨åˆ†çº§èšç±»ç®—æ³•é‡å¤(2)çš„å®éªŒï¼Œåœ¨ç®—æ³•ä¸­å°è¯•ä¸åŒçš„ç±»åˆ«è·ç¦»å’Œæ ·æœ¬è·ç¦»åº¦é‡æ–¹å¼ï¼Œé‡‡ç”¨ NMI è¯„ä¼°ä½ çš„èšç±»ç»“æœï¼Œç®€è¿°ä¸åŒè·ç¦»åº¦é‡æ–¹å¼çš„ç‰¹ç‚¹ã€‚

> æœ¬å®éªŒé‡‡ç”¨ä¸‰ç§æ ·æœ¬è·ç¦»åº¦é‡æ–¹å¼ï¼š
> * `euclidean`ï¼š$l_2$è·ç¦»
> * `manhattan`ï¼š$l_1$è·ç¦»
> * `cosine`ï¼šä½™å¼¦è·ç¦»
> 
> æœ¬å®éªŒé‡‡ç”¨ä¸‰ç§ç±»åˆ«è·ç¦»åº¦é‡æ–¹å¼ï¼š
> * `single`ï¼šæœ€å°è·ç¦»
> * `average`ï¼šå¹³å‡è·ç¦»
> * `complete`ï¼šæœ€å¤§è·ç¦»
>
>å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
```
nmi averages:
affinity = euclidean:
	linkage = single: 0.0012861646727329432
	linkage = average: 0.0038319082476843
	linkage = complete: 0.4024000777847923
affinity = manhattan:
	linkage = single: 0.0012861646727329432
	linkage = average: 0.004463767961463452
	linkage = complete: 0.5012809886649041
affinity = cosine:
	linkage = single: 0.0012861646727329432
	linkage = average: 0.5157251246336864
	linkage = complete: 0.42037008340277876
```
> ç”±æ­¤å¯è§ï¼Œåœ¨æœ¬æ¬¡ä»»åŠ¡ä¸­ï¼Œç±»åˆ«è·ç¦»åº¦é‡æ–¹å¼é€‰ä¸º`complete`çš„æ•ˆæœè¾ƒä¼˜ï¼Œé€‰ä¸ºå…¶ä»–ä¸¤ç§æ–¹å¼çš„èšç±»æ•ˆæœæ™®éè¾ƒå·®ï¼›ä¸åŒæ ·æœ¬è·ç¦»åº¦é‡æ–¹å¼å¯¹NMIå€¼æœ‰ä¸€å®šå½±å“ï¼›å¯¹äºä½™å¼¦è·ç¦»ï¼Œ`average`çš„ç±»åˆ«åº¦é‡æ–¹å¼ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚
> 
> ä¸åŒæ ·æœ¬è·ç¦»åº¦é‡æ–¹å¼çš„ç‰¹ç‚¹[^5] ï¼š
> * `euclidean`ã€`manhattan`ï¼šMinkowskiè·ç¦»çš„ä¸¤ä¸ªç‰¹ä¾‹ï¼Œè¡¡é‡èµ‹èŒƒå‘é‡ç©ºé—´ä¸­ä¸¤ç‚¹çš„è·ç¦»ã€‚`euclidean`æ˜¯æœ€å¸¸è§çš„2-èŒƒæ•°åº¦é‡ï¼›`manhattan`ä½œä¸º1-èŒƒæ•°ä¸æ˜“å—ç¦»ç¾¤ç‚¹å½±å“ï¼Œç›¸å¯¹äº2-èŒƒæ•°çš„é²æ£’æ€§æ›´å¼ºã€‚
> * `cosine`ï¼šä¸€ç§Pearsonç›¸å…³æ€§åº¦é‡ï¼Œè¡¡é‡èšç±»ç°‡çš„ä¸€è‡´ç¨‹åº¦ï¼Œåœ¨æ•°æ®åˆ†å¸ƒéæ­£æ€æ—¶é€šå¸¸ä¼šæ›´æœ‰æ•ˆï¼Œé€šå¸¸ç”¨äºæ–‡æœ¬æ•°æ®çš„è·ç¦»åº¦é‡ã€‚
>  
>  ä¸åŒç±»åˆ«è·ç¦»åº¦é‡æ–¹å¼çš„ç‰¹ç‚¹ï¼š
> * `single-linkage`ï¼šå€¾å‘äºäº§ç”Ÿé•¿è€Œç»†çš„ç°‡ï¼ˆé“¾å¼æ•ˆåº”ï¼‰ï¼šåŒä¸€ç°‡çš„ç›¸é‚»å…ƒç´ ä¹‹é—´çš„è·ç¦»å¾ˆå°ï¼Œä½†æ˜¯åœ¨ç°‡ä¸¤ç«¯çš„å…ƒç´ ä¹‹é—´çš„è·ç¦»å¯èƒ½æ¯”å…¶ä¸å¦å¤–ä¸€ç°‡çš„ä¸¤ä¸ªå…ƒç´ ç›¸è·æ›´è¿œã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥å®šä¹‰èƒ½æœ‰æ•ˆç»†åˆ†æ•°æ®çš„ç±»ç°‡[^6]ã€‚
> * `complete-linkage`ï¼šæœ‰æ•ˆé¿å…é“¾å¼æ•ˆåº”ï¼Œå€¾å‘äºå¯»æ‰¾ç›´å¾„è¿‘ä¼¼ç›¸ç­‰çš„ç´§è‡´ç°‡[^7]ï¼Œä½†ä¼šå‡ºç°ç¾¤èšæ•ˆåº”ï¼Œä½¿å¾—æ¯ä¸ªç°‡ä¹‹é—´çš„è·ç¦»è¿‡å°[^8]ã€‚
> * `average-linkage`ï¼šæ˜¯ä¸Šè¿°ä¸¤ç§æ–¹æ³•çš„æŠ˜ä¸­ï¼Œç±»çš„ç´§è‡´ç¨‹åº¦å’Œç±»é—´è·ç¦»éƒ½æ¯”è¾ƒåˆé€‚ï¼›ä½†å› ä¸ºè¿‡ç¨‹ä¸­å‘ç”Ÿäº†å‰ªæï¼Œä½¿å¾—å…¶è§£é‡Šæ€§é™ä½ï¼›èšç±»ç»“æœä¼šéšç€è·ç¦»åº¦é‡å‘ç”Ÿå˜åŒ–[^8]ã€‚




## å‚è€ƒèµ„æ–™
[^1]:[é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰åŠå…¶EMç®—æ³•çš„ç†è§£](https://blog.csdn.net/jinping_shi/article/details/59613054)
[^2]:[æ··åˆé«˜æ–¯æ¨¡å‹ï¼ˆå¤šå…ƒé«˜æ–¯æ±‚å¯¼ï¼‰](https://blog.csdn.net/SZU_Hadooper/article/details/78090348)
[^3]: [k-means++: The Advantages of Careful Seeding](http://ilpubs.stanford.edu:8090/778/1/2006-13.pdf)
[^4]: [K-Meansèšç±»ç®—æ³•åŸç†](https://www.cnblogs.com/pinard/p/6164214.html)
[^5]:[Clustering Algorithms using
Different Distance Measures](https://shodhganga.inflibnet.ac.in/bitstream/10603/90817/12/12_chapter8.pdf)
[^6]:[Single-linkage clustering](https://www.wikiwand.com/en/Single-linkage_clustering)
[^7]:[Complete-linkage clustering](https://www.wikiwand.com/en/Complete-linkage_clustering#/Comparison_with_other_linkages)
[^8]:[Clustering 2: Hierarchical clustering](https://www.stat.cmu.edu/~ryantibs/datamining/lectures/05-clus2.pdf)
<!--stackedit_data:
eyJoaXN0b3J5IjpbMjA2MTY0MjQ1MV19
-->