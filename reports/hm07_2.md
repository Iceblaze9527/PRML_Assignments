# 第七次作业_2
> 新雅62/CDIE6 
> 2016013327 项雨桐

## 9.3 计算机小实验 1:作弊骰子
一位赌场老板最近发现，一名玩家在掷骰子的游戏中总能取胜，他怀疑这名玩家在游戏中将公平骰子偷换成了不公平的骰子，于是他用摄像头拍下了每局游戏骰子的点数，希望请你帮忙分析出这名玩家是否偷换了骰子以及该骰子出现各点的概率。

1.  点数信息存于 sequences.npy 文件中，其中每一行是一局游戏，每一列是 一次掷骰子出现的点数，文件中总共包括 200 局游戏，每局游戏各掷骰子 30 次，请据此建立并训练 HMM 模型，并在报告中给出拟合得到的初始、转移、发射概率。

> 初始概率：
```
[0.3599 0.6401]
```
> 转移概率：
 ```
[0.9079 0.0921]
[0.0564 0.9436]
```
> 发射概率：
```
[0.105  0.1033 0.0954 0.0956 0.1037 0.4969]
[0.1647 0.1566 0.1789 0.1746 0.1753 0.1499]
```
> 可以发现骰子1是作弊骰子

2.  根据你建立的模型，分别采用前向算法和后向算法手动计算序列“6、6 、6、6”出现的概率，比较两次计算的结果是否相同。

> 结果如下所示：
```
FA：
alpha_1: [0.1789 0.0959]
alpha_2: [0.0834 0.016 ]
alpha_3: [0.0381 0.0034]
alpha_4: [0.0173 0.001 ]
prob: 0.0182793425451436
BA：
beta_4: [1. 1.]
beta_3: [0.465  0.1694]
beta_2: [0.2121 0.037 ]
beta_1: [0.0962 0.0112]
prob: 0.0182793425451436
```
> 可知两次计算结果相同

3.  假如这名玩家正在游戏中，目前已经观察到本局游戏前 15 次出现的点数为：3、2、1、3、4、5、6、3、1、4、1、6、6、2、6，请你根据所建立的模型，推断该玩家是否正在作弊，如果是，是在何时偷换的骰子?

> 利用模型对序列解码如下：
> ``state_seq = [1 1 1 1 1 1 1 1 1 1 1 0 0 0 0]``
> 可知玩家正在作弊，从第十二次开始偷换了作弊的骰子。

## 9.4 计算机小实验 2：垃圾邮件分类 
在本题中，我们将尝试建立朴素贝叶斯分类器对垃圾邮件进行分类。附件``spambase.data`` 中共包含 4601 封邮件信息，该文件的前 57 列为邮件特征，最后 1 列为分类标签，每一维特征的详细描述见 ``spambase.names`` 文件。请从所有样本中随机抽取 1000 封邮件作为测试集，用余下的样本作为训练集训练朴素贝叶斯分类器，并完成以下要求:

1. 给出测试集正确率  
> ``accuracy: 0.821``

2. 绘制混淆矩阵，计算出 TPR、FPR、TNR、FNR 
```
混淆矩阵：
[TN,FP]=[459, 165]
[FN,TP]=[ 14, 362]

TPR: 0.9627659574468085
FPR: 0.2644230769230769
TNR: 0.7355769230769231
FNR: 0.03723404255319149
```
3. 绘制 ROC 曲线，计算 AUC
> ROC曲线如下
> <a href="https://sm.ms/image/e6M9WglZOoFXjUk" target="_blank"><img src="https://i.loli.net/2020/04/04/e6M9WglZOoFXjUk.png" width="50%"></a>
> ``AUC: 0.9464462288597927``

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIyNDIyMzU5N119
-->